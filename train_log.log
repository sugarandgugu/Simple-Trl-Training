[2024-03-27 18:31:28,758] [INFO] [real_accelerator.py:110:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.

Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]
Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:11,  1.69s/it]
Loading checkpoint shards:  25%|██▌       | 2/8 [00:02<00:07,  1.27s/it]
Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:05,  1.14s/it]
Loading checkpoint shards:  50%|█████     | 4/8 [00:04<00:04,  1.09s/it]
Loading checkpoint shards:  62%|██████▎   | 5/8 [00:05<00:03,  1.06s/it]
Loading checkpoint shards:  75%|███████▌  | 6/8 [00:06<00:02,  1.04s/it]
Loading checkpoint shards:  88%|████████▊ | 7/8 [00:07<00:01,  1.03s/it]
Loading checkpoint shards: 100%|██████████| 8/8 [00:08<00:00,  1.07it/s]
Loading checkpoint shards: 100%|██████████| 8/8 [00:08<00:00,  1.05s/it]

Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]
Loading checkpoint shards:  12%|█▎        | 1/8 [00:00<00:06,  1.06it/s]
Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:06,  1.01s/it]
Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:05,  1.03s/it]
Loading checkpoint shards:  50%|█████     | 4/8 [00:04<00:04,  1.06s/it]
Loading checkpoint shards:  62%|██████▎   | 5/8 [00:05<00:03,  1.06s/it]
Loading checkpoint shards:  75%|███████▌  | 6/8 [00:06<00:02,  1.08s/it]
Loading checkpoint shards:  88%|████████▊ | 7/8 [00:07<00:01,  1.08s/it]
Loading checkpoint shards: 100%|██████████| 8/8 [00:08<00:00,  1.00it/s]
Loading checkpoint shards: 100%|██████████| 8/8 [00:08<00:00,  1.03s/it]

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 2811 examples [00:00, 176939.53 examples/s]
2024-03-27 18:31:49.488 | INFO     | __main__:run:99 - =============== starting training ===============
You are using 8-bit optimizers with a version of `bitsandbytes` < 0.41.1. It is recommended to update your version as a major bug has been fixed in 8-bit optimizers.

  0%|          | 0/175 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed

  1%|          | 1/175 [00:28<1:23:10, 28.68s/it]
  1%|          | 2/175 [00:55<1:19:57, 27.73s/it]
  2%|▏         | 3/175 [01:22<1:18:34, 27.41s/it]
  2%|▏         | 4/175 [01:49<1:17:40, 27.25s/it]
  3%|▎         | 5/175 [02:16<1:16:59, 27.17s/it]
  3%|▎         | 6/175 [02:43<1:16:25, 27.13s/it]
  4%|▍         | 7/175 [03:10<1:15:50, 27.09s/it]
  5%|▍         | 8/175 [03:37<1:15:18, 27.06s/it]
  5%|▌         | 9/175 [04:04<1:14:50, 27.05s/it]
  6%|▌         | 10/175 [04:31<1:14:20, 27.03s/it]
  6%|▋         | 11/175 [04:58<1:13:53, 27.03s/it]
  7%|▋         | 12/175 [05:25<1:13:26, 27.04s/it]
  7%|▋         | 13/175 [05:52<1:12:58, 27.03s/it]
  8%|▊         | 14/175 [06:20<1:12:31, 27.03s/it]
  9%|▊         | 15/175 [06:46<1:12:01, 27.01s/it]
  9%|▉         | 16/175 [07:13<1:11:33, 27.00s/it]
 10%|▉         | 17/175 [07:40<1:11:06, 27.00s/it]
 10%|█         | 18/175 [08:07<1:10:40, 27.01s/it]
 11%|█         | 19/175 [08:34<1:10:13, 27.01s/it]
 11%|█▏        | 20/175 [09:02<1:09:47, 27.01s/it]
 12%|█▏        | 21/175 [09:28<1:09:17, 27.00s/it]
 13%|█▎        | 22/175 [09:55<1:08:51, 27.00s/it]
 13%|█▎        | 23/175 [10:23<1:08:25, 27.01s/it]
 14%|█▎        | 24/175 [10:50<1:07:57, 27.00s/it]
 14%|█▍        | 25/175 [11:16<1:07:29, 27.00s/it]
 15%|█▍        | 26/175 [11:44<1:07:03, 27.01s/it]
 15%|█▌        | 27/175 [12:11<1:06:36, 27.00s/it]
 16%|█▌        | 28/175 [12:38<1:06:10, 27.01s/it]
 17%|█▋        | 29/175 [13:05<1:05:41, 27.00s/it]
 17%|█▋        | 30/175 [13:32<1:05:14, 27.00s/it]
 18%|█▊        | 31/175 [13:59<1:04:50, 27.01s/it]
 18%|█▊        | 32/175 [14:26<1:04:24, 27.03s/it]
 19%|█▉        | 33/175 [14:53<1:03:55, 27.01s/it]
 19%|█▉        | 34/175 [15:20<1:03:29, 27.02s/it]
 20%|██        | 35/175 [15:47<1:03:01, 27.01s/it]
 21%|██        | 36/175 [16:14<1:02:35, 27.02s/it]
 21%|██        | 37/175 [16:41<1:02:05, 27.00s/it]
 22%|██▏       | 38/175 [17:08<1:01:38, 26.99s/it]
 22%|██▏       | 39/175 [17:35<1:01:12, 27.01s/it]
 23%|██▎       | 40/175 [18:02<1:00:44, 27.00s/it]
 23%|██▎       | 41/175 [18:29<1:00:17, 27.00s/it]
 24%|██▍       | 42/175 [18:56<59:51, 27.01s/it]  
 25%|██▍       | 43/175 [19:23<59:26, 27.02s/it]
 25%|██▌       | 44/175 [19:50<59:00, 27.03s/it]
 26%|██▌       | 45/175 [20:17<58:32, 27.02s/it]
 26%|██▋       | 46/175 [20:44<58:06, 27.03s/it]
 27%|██▋       | 47/175 [21:11<57:39, 27.02s/it]
 27%|██▋       | 48/175 [21:38<57:10, 27.01s/it]
 28%|██▊       | 49/175 [22:05<56:43, 27.01s/it]
 29%|██▊       | 50/175 [22:32<56:15, 27.01s/it]
                                                

 29%|██▊       | 50/175 [22:32<56:15, 27.01s/it]
 29%|██▉       | 51/175 [22:59<55:50, 27.02s/it]
 30%|██▉       | 52/175 [23:26<55:23, 27.02s/it]
 30%|███       | 53/175 [23:53<54:57, 27.03s/it]
 31%|███       | 54/175 [24:20<54:29, 27.02s/it]
 31%|███▏      | 55/175 [24:47<54:00, 27.01s/it]
 32%|███▏      | 56/175 [25:14<53:34, 27.01s/it]
 33%|███▎      | 57/175 [25:41<53:09, 27.03s/it]
 33%|███▎      | 58/175 [26:08<52:41, 27.02s/it]
 34%|███▎      | 59/175 [26:35<52:15, 27.03s/it]
 34%|███▍      | 60/175 [27:02<51:49, 27.03s/it]
 35%|███▍      | 61/175 [27:29<51:21, 27.03s/it]
 35%|███▌      | 62/175 [27:56<50:54, 27.03s/it]
 36%|███▌      | 63/175 [28:23<50:25, 27.01s/it]
 37%|███▋      | 64/175 [28:50<49:58, 27.01s/it]
 37%|███▋      | 65/175 [29:17<49:32, 27.02s/it]
 38%|███▊      | 66/175 [29:44<49:05, 27.02s/it]
 38%|███▊      | 67/175 [30:11<48:39, 27.03s/it]
 39%|███▉      | 68/175 [30:38<48:12, 27.04s/it]
 39%|███▉      | 69/175 [31:05<47:44, 27.02s/it]
 40%|████      | 70/175 [31:32<47:17, 27.02s/it]
 41%|████      | 71/175 [31:59<46:50, 27.03s/it]
 41%|████      | 72/175 [32:26<46:24, 27.03s/it]
 42%|████▏     | 73/175 [32:53<45:57, 27.03s/it]
 42%|████▏     | 74/175 [33:20<45:30, 27.03s/it]
 43%|████▎     | 75/175 [33:47<45:02, 27.02s/it]
 43%|████▎     | 76/175 [34:14<44:34, 27.02s/it]
 44%|████▍     | 77/175 [34:41<44:07, 27.02s/it]
 45%|████▍     | 78/175 [35:08<43:39, 27.00s/it]
 45%|████▌     | 79/175 [35:35<43:12, 27.00s/it]
 46%|████▌     | 80/175 [36:02<42:46, 27.01s/it]
 46%|████▋     | 81/175 [36:29<42:20, 27.02s/it]
 47%|████▋     | 82/175 [36:56<41:52, 27.01s/it]
 47%|████▋     | 83/175 [37:23<41:24, 27.00s/it]
 48%|████▊     | 84/175 [37:50<40:56, 27.00s/it]
 49%|████▊     | 85/175 [38:17<40:30, 27.01s/it]
 49%|████▉     | 86/175 [38:44<40:03, 27.00s/it]
 50%|████▉     | 87/175 [39:11<39:36, 27.01s/it]
 50%|█████     | 88/175 [39:38<39:09, 27.01s/it]
 51%|█████     | 89/175 [40:06<38:42, 27.01s/it]
 51%|█████▏    | 90/175 [40:33<38:15, 27.00s/it]
 52%|█████▏    | 91/175 [41:00<37:49, 27.01s/it]
 53%|█████▎    | 92/175 [41:27<37:21, 27.01s/it]
 53%|█████▎    | 93/175 [41:54<36:54, 27.00s/it]
 54%|█████▎    | 94/175 [42:20<36:26, 26.99s/it]
 54%|█████▍    | 95/175 [42:48<36:00, 27.00s/it]
 55%|█████▍    | 96/175 [43:15<35:32, 27.00s/it]
 55%|█████▌    | 97/175 [43:41<35:05, 26.99s/it]
 56%|█████▌    | 98/175 [44:08<34:38, 26.99s/it]
 57%|█████▋    | 99/175 [44:35<34:11, 27.00s/it]
 57%|█████▋    | 100/175 [45:02<33:44, 26.99s/it]
                                                 

 57%|█████▋    | 100/175 [45:02<33:44, 26.99s/it]
 58%|█████▊    | 101/175 [45:30<33:19, 27.02s/it]
 58%|█████▊    | 102/175 [45:57<32:52, 27.02s/it]
 59%|█████▉    | 103/175 [46:24<32:26, 27.04s/it]
 59%|█████▉    | 104/175 [46:51<31:58, 27.02s/it]
 60%|██████    | 105/175 [47:18<31:32, 27.04s/it]
 61%|██████    | 106/175 [47:45<31:05, 27.03s/it]
 61%|██████    | 107/175 [48:12<30:38, 27.04s/it]
 62%|██████▏   | 108/175 [48:39<30:10, 27.03s/it]
 62%|██████▏   | 109/175 [49:06<29:43, 27.02s/it]
 63%|██████▎   | 110/175 [49:33<29:16, 27.03s/it]
 63%|██████▎   | 111/175 [50:00<28:49, 27.03s/it]
 64%|██████▍   | 112/175 [50:27<28:22, 27.03s/it]
 65%|██████▍   | 113/175 [50:54<27:54, 27.01s/it]
 65%|██████▌   | 114/175 [51:21<27:28, 27.03s/it]
 66%|██████▌   | 115/175 [51:48<27:02, 27.03s/it]
 66%|██████▋   | 116/175 [52:15<26:34, 27.02s/it]
 67%|██████▋   | 117/175 [52:42<26:07, 27.02s/it]
 67%|██████▋   | 118/175 [53:09<25:40, 27.02s/it]
 68%|██████▊   | 119/175 [53:36<25:13, 27.03s/it]
 69%|██████▊   | 120/175 [54:03<24:45, 27.01s/it]
 69%|██████▉   | 121/175 [54:30<24:18, 27.02s/it]
 70%|██████▉   | 122/175 [54:57<23:52, 27.02s/it]
 70%|███████   | 123/175 [55:24<23:25, 27.03s/it]
 71%|███████   | 124/175 [55:51<22:58, 27.02s/it]
 71%|███████▏  | 125/175 [56:18<22:31, 27.03s/it]
 72%|███████▏  | 126/175 [56:45<22:04, 27.02s/it]
 73%|███████▎  | 127/175 [57:12<21:36, 27.01s/it]
 73%|███████▎  | 128/175 [57:39<21:08, 27.00s/it]
 74%|███████▎  | 129/175 [58:06<20:42, 27.01s/it]
 74%|███████▍  | 130/175 [58:33<20:14, 27.00s/it]
 75%|███████▍  | 131/175 [59:00<19:47, 26.99s/it]
 75%|███████▌  | 132/175 [59:27<19:20, 27.00s/it]
 76%|███████▌  | 133/175 [59:54<18:53, 27.00s/it]
 77%|███████▋  | 134/175 [1:00:21<18:26, 27.00s/it]
 77%|███████▋  | 135/175 [1:00:48<17:59, 26.99s/it]
 78%|███████▊  | 136/175 [1:01:15<17:33, 27.00s/it]
 78%|███████▊  | 137/175 [1:01:42<17:06, 27.01s/it]
 79%|███████▉  | 138/175 [1:02:09<16:39, 27.00s/it]
 79%|███████▉  | 139/175 [1:02:36<16:12, 27.00s/it]
 80%|████████  | 140/175 [1:03:03<15:45, 27.00s/it]
 81%|████████  | 141/175 [1:03:30<15:18, 27.02s/it]
 81%|████████  | 142/175 [1:03:57<14:51, 27.01s/it]
 82%|████████▏ | 143/175 [1:04:24<14:24, 27.01s/it]
 82%|████████▏ | 144/175 [1:04:51<13:57, 27.01s/it]
 83%|████████▎ | 145/175 [1:05:18<13:30, 27.03s/it]
 83%|████████▎ | 146/175 [1:05:45<13:03, 27.03s/it]
 84%|████████▍ | 147/175 [1:06:12<12:36, 27.02s/it]
 85%|████████▍ | 148/175 [1:06:39<12:09, 27.03s/it]
 85%|████████▌ | 149/175 [1:07:06<11:42, 27.04s/it]
 86%|████████▌ | 150/175 [1:07:34<11:16, 27.05s/it]
                                                   

 86%|████████▌ | 150/175 [1:07:34<11:16, 27.05s/it]
 86%|████████▋ | 151/175 [1:08:01<10:49, 27.05s/it]
 87%|████████▋ | 152/175 [1:08:28<10:24, 27.17s/it]
 87%|████████▋ | 153/175 [1:08:55<09:56, 27.12s/it]
 88%|████████▊ | 154/175 [1:09:22<09:28, 27.09s/it]
 89%|████████▊ | 155/175 [1:09:49<09:01, 27.08s/it]
 89%|████████▉ | 156/175 [1:10:16<08:33, 27.05s/it]
 90%|████████▉ | 157/175 [1:10:43<08:06, 27.04s/it]
 90%|█████████ | 158/175 [1:11:10<07:39, 27.04s/it]
 91%|█████████ | 159/175 [1:11:37<07:12, 27.04s/it]
 91%|█████████▏| 160/175 [1:12:04<06:45, 27.05s/it]
 92%|█████████▏| 161/175 [1:12:31<06:18, 27.04s/it]
 93%|█████████▎| 162/175 [1:12:58<05:51, 27.04s/it]
 93%|█████████▎| 163/175 [1:13:25<05:24, 27.04s/it]
 94%|█████████▎| 164/175 [1:13:52<04:57, 27.05s/it]
 94%|█████████▍| 165/175 [1:14:20<04:30, 27.08s/it]
 95%|█████████▍| 166/175 [1:14:47<04:03, 27.07s/it]
 95%|█████████▌| 167/175 [1:15:14<03:36, 27.07s/it]
 96%|█████████▌| 168/175 [1:15:41<03:09, 27.06s/it]
 97%|█████████▋| 169/175 [1:16:08<02:42, 27.05s/it]
 97%|█████████▋| 170/175 [1:16:35<02:15, 27.05s/it]
 98%|█████████▊| 171/175 [1:17:02<01:48, 27.05s/it]
 98%|█████████▊| 172/175 [1:17:29<01:21, 27.06s/it]
 99%|█████████▉| 173/175 [1:17:56<00:54, 27.05s/it]
 99%|█████████▉| 174/175 [1:18:23<00:27, 27.06s/it]
100%|██████████| 175/175 [1:18:50<00:00, 27.07s/it]
                                                   

100%|██████████| 175/175 [1:18:50<00:00, 27.07s/it]
100%|██████████| 175/175 [1:18:50<00:00, 27.03s/it]
2024-03-27 19:50:40.234 | INFO     | __main__:run:101 - =============== Saving Model ===============
2024-03-27 19:50:40.459 | INFO     | __main__:run:103 - =============== Saving Metrics ===============
{'loss': 2451616399.36, 'learning_rate': 0.00025, 'rewards/chosen': nan, 'rewards/rejected': nan, 'rewards/accuracies': 0.008750000037252903, 'rewards/margins': nan, 'logps/rejected': nan, 'logps/chosen': nan, 'logits/rejected': nan, 'logits/chosen': nan, 'epoch': 0.28}
{'loss': 0.0, 'learning_rate': 0.0005, 'rewards/chosen': nan, 'rewards/rejected': nan, 'rewards/accuracies': 0.0, 'rewards/margins': nan, 'logps/rejected': nan, 'logps/chosen': nan, 'logits/rejected': nan, 'logits/chosen': nan, 'epoch': 0.57}
{'loss': 0.0, 'learning_rate': 0.0005, 'rewards/chosen': nan, 'rewards/rejected': nan, 'rewards/accuracies': 0.0, 'rewards/margins': nan, 'logps/rejected': nan, 'logps/chosen': nan, 'logits/rejected': nan, 'logits/chosen': nan, 'epoch': 0.85}
{'train_runtime': 4730.6083, 'train_samples_per_second': 0.594, 'train_steps_per_second': 0.037, 'train_loss': 700461828.3885714, 'epoch': 1.0}
***** train metrics *****
  epoch                    =            1.0
  train_loss               = 700461828.3886
  train_runtime            =     1:18:50.60
  train_samples_per_second =          0.594
  train_steps_per_second   =          0.037
